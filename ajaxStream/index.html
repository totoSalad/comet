<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>ajax streaming comet</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <script>
      function ajax() {
        var xhr = new XMLHttpRequest()
        var received = 0
        xhr.onreadystatechange = function() {
          if (xhr.readyState == 3) {
            result = xhr.responseText.substring(received)
            console.log(result)
            received += result.length
          } else if (xhr.readyState == 4) {
            console.log("完成消息推送")
          }
        }
        xhr.open("get", "/comet/ajax/stream")
        xhr.send(null)
      }
    </script>
  </head>
  <body>
    <button onclick="ajax()">点击开始ajax stream comet</button>
  </body>
</html>
